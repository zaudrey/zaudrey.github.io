<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Workflow</title>
  </head>
    <style>
        /* add a black background color to the top navigation */
                .topnav{
                    background-color: #333;
                    overflow: hidden;
                    font-family: Arial, Helvetica, sans-serif;
                 }
                /* style the links inside the navigation bar*/
                 .topnav a{
                     float: left;
                     color: #f2f2f2;
                     text-align: center;
                     padding: 14px 16px;
                     text-decoration: none;
                     font-size: 17px;
                 }
                /* change the color of the links on hover */
                .topnav a:hover{
                    background-color: #ddd;
                    color: black;
                }
                /* add a color ot the active/current link*/ 
                .topnav a.active{
                    background-color: #4CAF50;
                }

                /* changes font of body*/
                body{
                    font-family: Arial;
                }
      
                /* Fixed sidenav, full height */
                  .sidenav {
                    height: 100%;
                    width: 200px;
                    position: fixed;
                    z-index: 1;
                    top: 0;
                    left: 0;
                    background-color: #111;
                    overflow-x: hidden;
                    padding-top: 20px;
                  }

                  /* Style the sidenav links and the dropdown button */
                  .sidenav a, .dropdown-btn {
                    padding: 6px 8px 6px 16px;
                    text-decoration: none;
                    font-size: 20px;
                    color: #818181;
                    display: block;
                    border: none;
                    background: none;
                    width:100%;
                    text-align: left;
                    cursor: pointer;
                    outline: none;
                  }

                  /* On mouse-over */
                  .sidenav a:hover, .dropdown-btn:hover {
                    color: #f1f1f1;
                  }

                  /* Main content */
                  .main {
                    margin-left: 200px; /* Same as the width of the sidenav */
                    font-size: 20px; /* Increased text to enable scrolling */
                    padding: 0px 10px;
                  }

                  /* Add an active class to the active dropdown button */
                  .active {
                    background-color: green;
                    color: white;
                  }

                  /* Dropdown container (hidden by default). Optional: add a lighter background color and some left padding to change the design of the dropdown content */
                  .dropdown-container {
                    display: none;
                    background-color: #262626;
                    padding-left: 8px;
                  }

                  /* Optional: Style the caret down icon */
                  .fa-caret-down {
                    float: right;
                    padding-right: 8px;
                  }
      
    </style>
  
  <body>
    <div class="topnav"> 
          <a href="https://zaudrey.github.io/index.html#home">Home</a>
          <a href="https://taiji-pipeline.github.io/static/other/taiji.html">Workflow</a>
          <a href="https://zaudrey.github.io/install.html#install">Install</a>
          <a href="https://zaudrey.github.io/blog_1_ATAC.html">Tutorial</a>      
          <a href="https://taiji-pipeline.github.io/documentation/">Manual</a>
          <a class="active" href="https://zaudrey.github.io/algorithm.html">Algorithm</a>
          <a href="https://zaudrey.github.io/contact.html">Contact</a>
    </div>
    
    <h2>Constructing weighted TF regulatory network</h2>
    <p>The weighted network enable us to make use of many weak connections which otherwise will e excluded in an unweighted network.</p>
    
    <img src="https://zaudrey.github.io/algorithm-img1.png" alt="Algorithm Image 1">
         
         
    <p>The edge weight is a combination of three factors:</p>
    <ol>
      <li>Peak intensity <i>p</i>, represented by the p-value of a peak, rescaled to [0,1] by a sigmoid function.</li>
      <li>Motif binding affinity <i>m</i>, represented by the p-value of the motif binding score, rescaled to [0,1] by a sigmoid function.</li>
      <li>TF expression value <i>g</i>.</li>
    </ol>
    <p>If a TF <i>i</i> has <i>n</i> binding sites that are linked to gene <i>j</i>, then the edge weight is determined by:</p>
    <p>note: insert photo here</p>
    <h2>Computing TF ranks using the PageRank algorithm</h2>
    <p>Let <i>s</i> be the vector containing node weights and <b>W</b> be the edge weight matrix. The personalized PageRank score vector <i>v</i> was calculated by solving a 
      system of linear equations v=(1-d)s+dWv, where <i>d</i> is the damping factor (default to 0.85). The above equation can be solved in an interative fashion, <i>i.e.</i>
      , setting vt+1=(1-d)s+dWvt. </p>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/P8Kt6Abq_rM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; 
    encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    
    <h2>Statistical significance of PageRank scores</h2>
    <p>To determine the statistical significance of PageRank scores, we randomly rewire edges in the network and compute the PageRank scores. We do this 10 times to get enough
    samples for computing the null distribution. The p-values of PageRank scores were then inferred as to the null distribution.</p>
      
      
      
  </body>
</html>
